{
  "version": 3,
  "sources": ["../../../src/cli/dashboard.ts"],
  "sourcesContent": ["import { Command } from \"@commander-js/extra-typings\";\nimport chalk from \"chalk\";\nimport open from \"open\";\nimport { logMessage, logOutput, oneoffContext } from \"../bundler/context.js\";\nimport {\n  deploymentSelectionFromOptions,\n  fetchDeploymentCredentialsProvisionProd,\n} from \"./lib/api.js\";\nimport { actionDescription } from \"./lib/command.js\";\n\nconst DASHBOARD_HOST = process.env.CONVEX_PROVISION_HOST\n  ? \"http://localhost:6789\"\n  : \"https://dashboard.convex.dev\";\n\nexport const dashboard = new Command(\"dashboard\")\n  .description(\"Open the dashboard in the browser\")\n  .allowExcessArguments(false)\n  .option(\n    \"--no-open\",\n    \"Don't automatically open the dashboard in the default browser\",\n  )\n  .addDeploymentSelectionOptions(actionDescription(\"Open the dashboard for\"))\n  .showHelpAfterError()\n  .action(async (options) => {\n    const ctx = oneoffContext();\n\n    const deploymentSelection = await deploymentSelectionFromOptions(\n      ctx,\n      options,\n    );\n    const { deploymentName } = await fetchDeploymentCredentialsProvisionProd(\n      ctx,\n      deploymentSelection,\n      { ensureLocalRunning: false },\n    );\n\n    if (deploymentName === undefined) {\n      if (deploymentSelection.kind === \"urlWithAdminKey\") {\n        const msg = `Self-hosted deployment configured.\\n\\`${chalk.bold(\"npx convex dashboard\")}\\` is not supported for self-hosted deployments.\\nSee self-hosting instructions for how to self-host the dashboard.`;\n        logMessage(ctx, chalk.yellow(msg));\n        return;\n      }\n      return await ctx.crash({\n        exitCode: 1,\n        errorType: \"invalid filesystem data\",\n        printedMessage: `No Convex deployment configured, run \\`${chalk.bold(\n          \"npx convex dev\",\n        )}\\``,\n      });\n    }\n\n    const loginUrl = deploymentDashboardUrlPage(deploymentName, \"\");\n\n    if (options.open) {\n      logMessage(\n        ctx,\n        chalk.gray(`Opening ${loginUrl} in the default browser...`),\n      );\n      await open(loginUrl);\n    } else {\n      logOutput(ctx, loginUrl);\n    }\n  });\n\nexport function deploymentDashboardUrlPage(\n  configuredDeployment: string | null,\n  page: string,\n): string {\n  return `${DASHBOARD_HOST}/d/${configuredDeployment}${page}`;\n}\n\nexport function deploymentDashboardUrl(\n  team: string,\n  project: string,\n  deploymentName: string,\n) {\n  return `${projectDashboardUrl(team, project)}/${deploymentName}`;\n}\n\nexport function projectDashboardUrl(team: string, project: string) {\n  return `${teamDashboardUrl(team)}/${project}`;\n}\n\nexport function teamDashboardUrl(team: string) {\n  return `${DASHBOARD_HOST}/t/${team}`;\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BAAwB;AACxB,mBAAkB;AAClB,kBAAiB;AACjB,qBAAqD;AACrD,iBAGO;AACP,qBAAkC;AAElC,MAAM,iBAAiB,QAAQ,IAAI,wBAC/B,0BACA;AAEG,MAAM,YAAY,IAAI,6BAAQ,WAAW,EAC7C,YAAY,mCAAmC,EAC/C,qBAAqB,KAAK,EAC1B;AAAA,EACC;AAAA,EACA;AACF,EACC,kCAA8B,kCAAkB,wBAAwB,CAAC,EACzE,mBAAmB,EACnB,OAAO,OAAO,YAAY;AACzB,QAAM,UAAM,8BAAc;AAE1B,QAAM,sBAAsB,UAAM;AAAA,IAChC;AAAA,IACA;AAAA,EACF;AACA,QAAM,EAAE,eAAe,IAAI,UAAM;AAAA,IAC/B;AAAA,IACA;AAAA,IACA,EAAE,oBAAoB,MAAM;AAAA,EAC9B;AAEA,MAAI,mBAAmB,QAAW;AAChC,QAAI,oBAAoB,SAAS,mBAAmB;AAClD,YAAM,MAAM;AAAA,IAAyC,aAAAA,QAAM,KAAK,sBAAsB,CAAC;AAAA;AACvF,qCAAW,KAAK,aAAAA,QAAM,OAAO,GAAG,CAAC;AACjC;AAAA,IACF;AACA,WAAO,MAAM,IAAI,MAAM;AAAA,MACrB,UAAU;AAAA,MACV,WAAW;AAAA,MACX,gBAAgB,0CAA0C,aAAAA,QAAM;AAAA,QAC9D;AAAA,MACF,CAAC;AAAA,IACH,CAAC;AAAA,EACH;AAEA,QAAM,WAAW,2BAA2B,gBAAgB,EAAE;AAE9D,MAAI,QAAQ,MAAM;AAChB;AAAA,MACE;AAAA,MACA,aAAAA,QAAM,KAAK,WAAW,QAAQ,4BAA4B;AAAA,IAC5D;AACA,cAAM,YAAAC,SAAK,QAAQ;AAAA,EACrB,OAAO;AACL,kCAAU,KAAK,QAAQ;AAAA,EACzB;AACF,CAAC;AAEI,SAAS,2BACd,sBACA,MACQ;AACR,SAAO,GAAG,cAAc,MAAM,oBAAoB,GAAG,IAAI;AAC3D;AAEO,SAAS,uBACd,MACA,SACA,gBACA;AACA,SAAO,GAAG,oBAAoB,MAAM,OAAO,CAAC,IAAI,cAAc;AAChE;AAEO,SAAS,oBAAoB,MAAc,SAAiB;AACjE,SAAO,GAAG,iBAAiB,IAAI,CAAC,IAAI,OAAO;AAC7C;AAEO,SAAS,iBAAiB,MAAc;AAC7C,SAAO,GAAG,cAAc,MAAM,IAAI;AACpC;",
  "names": ["chalk", "open"]
}
